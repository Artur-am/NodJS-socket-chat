let userLogin="",socket=null;function Connecte(){document.forms["form-message"].elements.submit.removeAttribute("disabled")}function Disconnect(){document.forms["form-message"].elements.submit.setAttribute("disabled","")}function create(e){let t=document.createElement(e.tag);if("attribute"in e)for(let n in e.attribute)t.setAttribute(n,e.attribute[n]);return"text"in e&&(t.textContent=e.text),t}function MessageNotification(){document.getElementsByClassName("message-notification")[0].play()}function Chat(){function e(){let e=document.forms["form-message"].elements,t=new Date;this.login=userLogin,this.message=e.message.value,this.date=t.getHours()+":"+t.getMinutes()+":"+t.getSeconds(),e.message.value=""}function t(e){let t=document.createElement("li");t.appendChild(create({tag:"span",text:e.login})),t.appendChild(create({tag:"span",class:"list-message",text:e.message})),t.appendChild(create({tag:"span",text:e.date})),document.getElementsByClassName("lists")[0].appendChild(t)}socket.on("message",t),socket.on("other-message",function(e){MessageNotification(),t(e)}),document.forms["form-message"].addEventListener("submit",function(t){t.preventDefault();let n=new e;socket.emit("message",n)})}!function(){let e=create({tag:"script",attribute:{src:location.protocol+"//"+location.host+"/socket.io/socket.io.js"}});if(document.head.appendChild(e),"undefined"!=typeof Storage&&(userLogin=localStorage.getItem("login")))return null;function t(e,t=!0){let n=t?"add":"remove";document.body.classList[n]("modal"),document.getElementsByClassName(e)[0].classList[n]("modal-active")}t("modal-user-info"),document.forms["get-login"].addEventListener("submit",function(e){e.preventDefault();let n=document.forms["get-login"].elements.login.value.trim();n&&(localStorage.setItem("login",n),userLogin=n,t("modal-user-info",!1))})}(),window.addEventListener("load",function(){(socket=io()).on("conected",Connecte),socket.on("disconnect",Disconnect),Chat()});
